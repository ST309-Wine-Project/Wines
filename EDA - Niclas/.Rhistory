geom_histogram(aes(y = ..count.. / sum(..count..)), binwidth = 1) +
facet_wrap(~taster_name) +
labs(title = "Score distributions by reviewer") +
ylab("proportion") +
theme(strip.background = element_blank())
wines %>%
filter(taster_name %in% c("Roger Voss", "Michael Schachner", "Kerin Oâ€™Keefe", "Virginie Boone", "Paul Gregutt", "Matt Kettmann")) %>%
ggplot(aes(x = points, fill = taster_name)) +
geom_histogram(aes(y = ..count.. / sum(..count..)), binwidth = 1) +
facet_wrap(~taster_name) +
labs(title = "Score distributions by reviewer") +
ylab("proportion") +
theme(strip.background = element_blank(), strip.text.x = element_blank())
wines %>%
filter(taster_name %in% c("Roger Voss", "Michael Schachner", "Kerin Oâ€™Keefe", "Virginie Boone", "Paul Gregutt", "Matt Kettmann")) %>%
ggplot(aes(x = points, fill = taster_name)) +
geom_histogram(aes(y = ..count.. / sum(..count..)), binwidth = 1) +
facet_wrap(~taster_name) +
labs(title = "Score distributions by reviewer") +
ylab("proportion") +
theme(strip.background = element_blank(), strip.text.x = element_blank())
summary(wines$vintage)
summary(wines$price)
wines %>%
ggplot(aes(x = price)) +
geom_histogram(binwidth = 1) +
xlim(0, 250) +
labs(title = "Variation in wine prices")
wines %>%
ggplot(aes(x = price)) +
geom_freqpoly(aes(y = ..density..),binwidth = 1) +
xlim(0, 250)
wines %>%
ggplot(aes(x = points)) +
geom_freqpoly(aes(y = ..density..), binwidth = 1) +
labs(title = "Distribution of review points")
wines %>%
ggplot(aes(x = points)) +
geom_freqpoly(aes(y = ..density.., colour = taster_name), binwidth = 1)
wines %>%
ggplot(aes(x = as.factor(points), y = log(price))) +
geom_boxplot() +
labs(title = "Points v. Log Prices") +
xlab("Points") + ylab("Log(Price)")
wines %>%
ggplot(aes(x = as.factor(points), y = log(price))) +
geom_boxplot() +
labs(title = "Points v. Log Prices") +
xlab("Points") + ylab("Log(Price)")
# by country
wines %>%
group_by(country) %>%
summarise(n = n()) %>%
filter(n > 100) %>%
ggplot(aes(x = reorder(country,-n), y = n)) +
geom_histogram(stat = "identity") +
coord_flip() +
labs(title = "Variation in wine country") +
xlab("# of wines") + ylab("Country")
#1995-2020
wines %>%
ggplot(aes(x = vintage)) +
geom_histogram(binwidth = 1) +
xlim(1995,2020) +
labs(title = "# wines by vintage (1995-2020)")
#1950-1995
wines %>%
ggplot(aes(x = vintage)) +
geom_histogram(binwidth = 1) +
xlim(1900,1995) +
labs(title = "# wines by vintage (1900-1995)")
wines %>%
filter(between(vintage, 2000, 2017)) %>%
ggplot(aes(x = as.factor(vintage), y = log(price))) +
geom_boxplot() +
coord_flip() +
labs(title = "Vintage v. Log Price (2000-2017)") +
xlab("Log(Price)") +
ylab("Vintage")
wines %>%
filter(between(vintage, 1980, 2000)) %>%
ggplot(aes(x = as.factor(vintage), y = log(price))) +
geom_boxplot() +
coord_flip() +
labs(title = "Vintage v. Log Price (1980-2000)") +
xlab("Log(Price)") +
ylab("Vintage")
wines %>%
filter(between(vintage, 2000, 2017)) %>%
ggplot(aes(x = as.factor(vintage), y = points)) +
geom_boxplot() +
coord_flip() +
labs(title = "Vintage v. Points (2000-2017)") +
xlab("Points") +
ylab("Vintage")
wines %>%
filter(between(vintage, 1980, 2000)) %>%
ggplot(aes(x = as.factor(vintage), y = points)) +
geom_boxplot() +
coord_flip() +
labs(title = "Vintage v. Points (1980-2000)") +
xlab("Points") +
ylab("Vintage")
wines %>%
filter(between(vintage,2004, 2015)) %>%
filter(price < 1750) %>%
ggplot(aes(x = points, y = ..density..)) +
geom_freqpoly(binwidth = 1) +
facet_wrap(~vintage) +
labs(title = "Point distributions for vintages 2004 to 2015")
wines %>%
filter(between(vintage,2010, 2015)) %>%
filter(price < 1750) %>%
ggplot(aes(x = as.factor(points), y = price)) +
geom_boxplot() +
facet_wrap(~vintage) +
labs(title = "Points v. Price for vintages 2010 to 2015") +
xlab("points")
wines %>%
group_by(taster_name) %>%
summarise(n = n()) %>%
ggplot(aes(x = reorder(taster_name, -n), y = n)) +
geom_bar(stat = "identity") +
coord_flip() +
labs(title = "Variation in wine reviewers") +
ylab("# of wines reviewed") +
xlab("reviewer")
nrow(filter(wines, taster_name == "Carrie Dykes"))
nrow(filter(wines, taster_name == "Alexander Peartree"))
wines %>%
filter(!(taster_name %in% c("Carrie Dykes", "Fiona Adams", "Christina Pickard"))) %>%
ggplot(aes(x = reorder(taster_name, points, FUN = median), y = points)) +
geom_boxplot() +
coord_flip() +
labs(title = "Point distribution by wine reviewer") +
xlab("reviewer")
wines %>%
filter(taster_name %in% c("Roger Voss", "Michael Schachner", "Kerin Oâ€™Keefe", "Virginie Boone", "Paul Gregutt", "Matt Kettmann")) %>%
ggplot(aes(x = points, fill = taster_name)) +
geom_histogram(aes(y = ..count.. / sum(..count..)), binwidth = 1) +
facet_wrap(~taster_name) +
labs(title = "Score distributions by reviewer") +
ylab("proportion") +
theme(strip.background = element_blank(), strip.text.x = element_blank())
wines %>%
group_by(title) %>%
summary(n = n())
View(wines %>%
group_by(title) %>%
summary(n = n()))
wines %>%
group_by(title) %>%
summary(n = n())
wines %>%
group_by(title) %>%
summary(n = n())
wines %>%
group_by(title) %>%
summaryise(n = n())
wines %>%
group_by(title) %>%
summarise(n = n())
wines %>%
group_by(title) %>%
mutate(n = n())
View(wines %>%
group_by(title) %>%
mutate(n = n()))
View(wines %>%
group_by(variety, winery, vintage, title) %>%
arrange(title))
View(wines %>%
group_by(variety, winery))
Voss_Schachner = wines %>%
filter(taster_name %in% c("Roger Vox", "Roger Voss")) %>%
arrange(title)
View(Voss_Schachner)
Voss_Schachner = wines %>%
filter(taster_name %in% c("Matt Schachner", "Roger Voss")) %>%
arrange(title)
Voss_Schachner
View(Voss_Schachner)
Voss_Schachner = wines %>%
filter(taster_name %in% c("Michael Schachner", "Roger Voss")) %>%
arrange(title)
View(Voss_Schachner)
Voss_Schachner = wines %>%
filter(taster_name %in% c("Michael Schachner", "Roger Voss")) %>%
group_by(variety) %>%
summarise(avg_points = mean(points))
View(Voss_Schachner)
Voss_Schachner = wines %>%
filter(taster_name %in% c("Michael Schachner", "Roger Voss")) %>%
group_by(variety) %>%
summarise(taster_name = taster_name, avg_points = mean(points))
Voss_Schachner = wines %>%
filter(taster_name %in% c("Michael Schachner", "Roger Voss")) %>%
group_by(variety) %>%
transmute(variety = variety, taster_name = taster_name, avg_points = mean(points))
Voss_Schachner = wines %>%
filter(taster_name %in% c("Michael Schachner", "Roger Voss")) %>%
group_by(variety) %>%
transmute(taster_name = taster_name, avg_points = mean(points))
Voss_Schachner = wines %>%
filter(taster_name %in% c("Michael Schachner", "Roger Voss")) %>%
group_by(variety) %>%
transmute(taster_name = taster_name, avg_points = mean(points)) %>%
arrange(variety)
Voss_Schachner = wines %>%
filter(taster_name %in% c("Michael Schachner", "Roger Voss")) %>%
group_by(variety) %>%
transmute(avg_points = mean(points)) %>%
arrange(variety)
Voss_Schachner = wines %>%
filter(taster_name %in% c("Michael Schachner", "Roger Voss")) %>%
group_by(taster_name, variety) %>%
summarise(avg_points = mean(points)) %>%
arrange(variety)
View(wines)
summary(wines$vintage)
summary(wines$price)
wines %>%
ggplot(aes(x = price)) +
geom_histogram(binwidth = 1) +
xlim(0, 250) +
labs(title = "Variation in wine prices")
wines %>%
ggplot(aes(x = price)) +
geom_freqpoly(aes(y = ..density..),binwidth = 1) +
xlim(0, 250)
wines %>%
ggplot(aes(x = points)) +
geom_freqpoly(aes(y = ..density..), binwidth = 1) +
labs(title = "Distribution of review points")
wines %>%
ggplot(aes(x = points)) +
geom_freqpoly(aes(y = ..density.., colour = taster_name), binwidth = 1)
wines %>%
ggplot(aes(x = as.factor(points), y = log(price))) +
geom_boxplot() +
labs(title = "Points v. Log Prices") +
xlab("Points") + ylab("Log(Price)")
# by country
wines %>%
group_by(country) %>%
summarise(n = n()) %>%
filter(n > 100) %>%
ggplot(aes(x = reorder(country,-n), y = n)) +
geom_histogram(stat = "identity") +
coord_flip() +
labs(title = "Variation in wine country") +
xlab("# of wines") + ylab("Country")
#1995-2020
wines %>%
ggplot(aes(x = vintage)) +
geom_histogram(binwidth = 1) +
xlim(1995,2020) +
labs(title = "# wines by vintage (1995-2020)")
wines %>%
group_by(taster_name) %>%
summarise(n = n()) %>%
ggplot(aes(x = reorder(taster_name, -n), y = n)) +
geom_bar(stat = "identity") +
coord_flip() +
labs(title = "Variation in wine reviewers") +
ylab("# of wines reviewed") +
xlab("reviewer")
Voss_Schachner = wines %>%
filter(taster_name %in% c("Michael Schachner", "Roger Voss")) %>%
group_by(taster_name, variety) %>%
summarise(avg_points = mean(points)) %>%
arrange(variety)
Voss_Schachner = wines %>%
filter(taster_name %in% c("Michael Schachner", "Roger Voss")) %>%
group_by(taster_name, variety) %>%
summarise(avg_points = mean(points)) %>%
arrange(variety)
wines %>%
group_by(taster_name) %>%
summarise(n = n()) %>%
ggplot(aes(x = reorder(taster_name, -n), y = n)) +
geom_bar(stat = "identity") +
coord_flip() +
labs(title = "Variation in wine reviewers") +
ylab("# of wines reviewed") +
xlab("reviewer")
wines %>%
filter(!(taster_name %in% c("Carrie Dykes", "Fiona Adams", "Christina Pickard"))) %>%
ggplot(aes(x = reorder(taster_name, points, FUN = median), y = points)) +
geom_boxplot() +
coord_flip() +
labs(title = "Point distribution by wine reviewer") +
xlab("reviewer")
wines %>%
filter(between(vintage, 1980, 2000)) %>%
ggplot(aes(x = as.factor(vintage), y = points)) +
geom_boxplot() +
coord_flip() +
labs(title = "Vintage v. Points (1980-2000)") +
xlab("Points") +
ylab("Vintage")
wines %>%
group_by(variety) %>%
summarise(n = n()) %>%
filter(n > 100) %>%
ggplot(aes(x = reorder(variety,-n), y = n)) +
geom_histogram(stat = "identity") +
coord_flip() +
labs(title = "Variation in wine variety") +
xlab("# of wines") + ylab("Variety")
wines %>%
group_by(variety) %>%
summarise(n = n()) %>%
filter(n > 5000) %>%
ggplot(aes(x = reorder(variety,-n), y = n)) +
geom_histogram(stat = "identity") +
coord_flip() +
labs(title = "Variation in wine variety") +
xlab("# of wines") + ylab("Variety")
wines %>%
group_by(variety) %>%
summarise(n = n()) %>%
filter(n > 2000) %>%
ggplot(aes(x = reorder(variety,-n), y = n)) +
geom_histogram(stat = "identity") +
coord_flip() +
labs(title = "Variation in wine variety") +
xlab("# of wines") + ylab("Variety")
wines %>%
group_by(variety) %>%
summarise(n = n()) %>%
filter(n > 1000) %>%
ggplot(aes(x = reorder(variety,-n), y = n)) +
geom_histogram(stat = "identity") +
coord_flip() +
labs(title = "Variation in wine variety") +
xlab("# of wines") + ylab("Variety")
wines %>%
group_by(variety) %>%
summarise(n = n()) %>%
filter(n > 1500) %>%
ggplot(aes(x = reorder(variety,-n), y = n)) +
geom_histogram(stat = "identity") +
coord_flip() +
labs(title = "Variation in wine variety") +
xlab("# of wines") + ylab("Variety")
wines %>%
group_by(variety) %>%
summarise(n = n()) %>%
filter(n > 1500) %>%
ggplot(aes(x = reorder(variety,-n), y = n)) +
geom_histogram(stat = "identity") +
labs(title = "Variation in wine variety") +
xlab("# of wines") + ylab("Variety") +
coord_flip()
wines %>%
group_by(variety) %>%
summarise(n = n()) %>%
filter(n > 1500) %>%
ggplot(aes(x = reorder(variety,-n), y = n)) +
geom_histogram(stat = "identity") +
coord_flip() +
labs(title = "Variation in wine variety") +
xlab("variety") + ylab("# of wines")
# by country
wines %>%
group_by(country) %>%
summarise(n = n()) %>%
filter(n > 100) %>%
ggplot(aes(x = reorder(country,-n), y = n)) +
geom_histogram(stat = "identity") +
coord_flip() +
labs(title = "Variation in wine country") +
xlab("# of wines") + ylab("Country")
# by country
wines %>%
group_by(country) %>%
summarise(n = n()) %>%
filter(n > 100) %>%
ggplot(aes(x = reorder(country,-n), y = n)) +
geom_histogram(stat = "identity") +
coord_flip() +
labs(title = "Variation in wine country") +
xlab("country") + ylab("# of wines")
#1995-2020
wines %>%
ggplot(aes(x = vintage)) +
geom_histogram(binwidth = 1) +
xlim(1995,2020) +
labs(title = "# wines by vintage (1995-2020)")
#1950-1995
wines %>%
ggplot(aes(x = vintage)) +
geom_histogram(binwidth = 1) +
xlim(1900,1995) +
labs(title = "# wines by vintage (1900-1995)")
wines %>%
filter(between(vintage, 2000, 2017)) %>%
ggplot(aes(x = as.factor(vintage), y = log(price))) +
geom_boxplot() +
coord_flip() +
labs(title = "Vintage v. Log Price (2000-2017)") +
xlab("Log(Price)") +
ylab("Vintage")
wines %>%
filter(between(vintage, 1980, 2000)) %>%
ggplot(aes(x = as.factor(vintage), y = log(price))) +
geom_boxplot() +
coord_flip() +
labs(title = "Vintage v. Log Price (1980-2000)") +
xlab("Log(Price)") +
ylab("Vintage")
# by country
wines %>%
group_by(country) %>%
summarise(n = n()) %>%
filter(n > 100) %>%
ggplot(aes(x = reorder(country,-n), y = n)) +
geom_histogram(stat = "identity") +
coord_flip() +
labs(title = "Variation in wine country") +
xlab("variet") + ylab("# of wines")
# by country
wines %>%
group_by(country) %>%
summarise(n = n()) %>%
filter(n > 100) %>%
ggplot(aes(x = reorder(country,-n), y = n)) +
geom_histogram(stat = "identity") +
coord_flip() +
labs(title = "Variation in wine country") +
xlab("variety") + ylab("# of wines")
View(Voss_Schachner)
grep("t","abt")
grep("t","abtt")
grep("t",c("at", "bt"))
grep("t",c("at", "bt"))
grep("t",c("at", "bt", "ct"))
grep("t",c("at", "bt", "c"))
regexpr("t","abtt")
regexpr("t","abtt")
wines <- mutate(wines, vintage = ifelse((vintage > 2020 | vintage < 1900), NA, vintage))
summary(wines$vintage)
summary(wines$price)
wines %>%
ggplot(aes(x = price)) +
geom_histogram(binwidth = 1) +
xlim(0, 250) +
labs(title = "Variation in wine prices")
wines %>%
ggplot(aes(x = price)) +
geom_freqpoly(aes(y = ..density..),binwidth = 1) +
xlim(0, 250)
wines %>%
ggplot(aes(x = points)) +
geom_freqpoly(aes(y = ..density..), binwidth = 1) +
labs(title = "Distribution of review points")
wines %>%
ggplot(aes(x = points)) +
geom_freqpoly(aes(y = ..density.., colour = taster_name), binwidth = 1)
wines %>%
ggplot(aes(x = as.factor(points), y = log(price))) +
geom_boxplot() +
labs(title = "Points v. Log Prices") +
xlab("Points") + ylab("Log(Price)")
wines %>%
group_by(variety) %>%
summarise(n = n()) %>%
filter(n > 1500) %>%
ggplot(aes(x = reorder(variety,-n), y = n)) +
geom_histogram(stat = "identity") +
coord_flip() +
labs(title = "Variation in wine variety") +
xlab("variety") + ylab("# of wines")
# by country
wines %>%
group_by(country) %>%
summarise(n = n()) %>%
filter(n > 100) %>%
ggplot(aes(x = reorder(country,-n), y = n)) +
geom_histogram(stat = "identity") +
coord_flip() +
labs(title = "Variation in wine country") +
xlab("variety") + ylab("# of wines")
#1995-2020
wines %>%
ggplot(aes(x = vintage)) +
geom_histogram(binwidth = 1) +
xlim(1995,2020) +
labs(title = "# wines by vintage (1995-2020)")
#1950-1995
wines %>%
ggplot(aes(x = vintage)) +
geom_histogram(binwidth = 1) +
xlim(1900,1995) +
labs(title = "# wines by vintage (1900-1995)")
wines %>%
filter(between(vintage, 2000, 2017)) %>%
ggplot(aes(x = as.factor(vintage), y = log(price))) +
geom_boxplot() +
coord_flip() +
labs(title = "Vintage v. Log Price (2000-2017)") +
xlab("Log(Price)") +
ylab("Vintage")
wines %>%
filter(between(vintage, 2000, 2017)) %>%
ggplot(aes(x = as.factor(vintage), y = points)) +
geom_boxplot() +
coord_flip() +
labs(title = "Vintage v. Points (2000-2017)") +
ylab("Points") +
xlab("Vintage")
